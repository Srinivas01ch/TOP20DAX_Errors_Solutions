<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive DAX Errors Explorer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400&family=Montserrat:wght@700;800&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm & Balanced -->
    <!-- Application Structure Plan: The SPA is architected around thematic categories (Fundamentals, Model & Relationships, Context & Logic, Performance & Advanced) rather than a linear list. This structure was chosen because it aligns with a user's mental model for debugging—they often know the *type* of problem they're facing. The primary interaction is a filter-based navigation system where users select a category to dynamically display relevant error cards. This task-oriented design reduces cognitive load, allowing users to quickly find solutions for specific problems instead of scrolling through all 20 errors. A visual dashboard-style introduction with a chart provides an immediate overview, enhancing user engagement and synthesis of the content. -->
    <!-- Visualization & Content Choices: 
        - Report Info: Error Category Distribution -> Goal: Inform -> Viz/Presentation Method: Donut Chart -> Interaction: Hover for details -> Justification: Provides a high-level visual summary of error types, acting as a visual table of contents. -> Library/Method: Chart.js (Canvas).
        - Report Info: Navigating Error Types -> Goal: Organize -> Viz/Presentation Method: Filter Buttons -> Interaction: Click to filter displayed content -> Justification: The core interactive element that enables the thematic exploration of the content, making the application dynamic and user-driven. -> Library/Method: HTML/JS.
        - Report Info: Individual DAX Errors -> Goal: Inform -> Viz/Presentation Method: Content Cards with Code Snippets -> Interaction: Dynamically shown/hidden by filter -> Justification: Organizes each error into a digestible, self-contained component with clear visual distinction between correct and incorrect code. -> Library/Method: HTML/CSS/JS.
        - Report Info: Performance Impact -> Goal: Compare -> Viz/Presentation Method: Horizontal Bar Chart -> Interaction: Hover for exact values -> Justification: Visually quantifies the performance difference between inefficient and efficient DAX patterns, making the advice more impactful than text alone. -> Library/Method: Chart.js (Canvas).
        - Report Info: Abstract Concepts (e.g., Circular Dependency) -> Goal: Inform -> Viz/Presentation Method: Styled Diagrams -> Interaction: None -> Justification: Simplifies complex, abstract concepts into easily understood visuals. -> Library/Method: HTML/CSS/Unicode.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            background-color: #F3F4F6;
            color: #374151;
            font-family: 'Inter', sans-serif;
        }
        h1, h2, h3, h4 {
            font-family: 'Montserrat', sans-serif;
            color: #111827;
        }
        .font-code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .nav-button.active {
            background-color: #0d9488;
            color: #ffffff;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(13, 148, 136, 0.3);
        }
        .error-card {
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-50 border-b border-gray-200">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <h1 class="text-xl font-extrabold tracking-tight text-teal-700">DAX DEBUGGER</h1>
            <nav id="navigation" class="hidden md:flex items-center space-x-2">
                 <button data-category="all" class="nav-button active text-sm font-semibold px-4 py-2 rounded-full transition-all duration-300 ease-in-out hover:bg-teal-600 hover:text-white hover:shadow-lg">All Errors</button>
                 <button data-category="fundamentals" class="nav-button text-sm font-semibold px-4 py-2 rounded-full transition-all duration-300 ease-in-out hover:bg-teal-600 hover:text-white hover:shadow-lg">Fundamentals</button>
                 <button data-category="model" class="nav-button text-sm font-semibold px-4 py-2 rounded-full transition-all duration-300 ease-in-out hover:bg-teal-600 hover:text-white hover:shadow-lg">Model & Relationships</button>
                 <button data-category="context" class="nav-button text-sm font-semibold px-4 py-2 rounded-full transition-all duration-300 ease-in-out hover:bg-teal-600 hover:text-white hover:shadow-lg">Context & Logic</button>
                 <button data-category="performance" class="nav-button text-sm font-semibold px-4 py-2 rounded-full transition-all duration-300 ease-in-out hover:bg-teal-600 hover:text-white hover:shadow-lg">Performance & Advanced</button>
            </nav>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 md:py-12">

        <section id="hero" class="text-center py-10 md:py-16">
            <h2 class="text-4xl md:text-5xl font-extrabold mb-4">Interactive DAX Errors Explorer</h2>
            <p class="text-lg md:text-xl text-gray-600 max-w-3xl mx-auto mb-10">
                An interactive guide to the 20 most common DAX errors. Select a category to filter the content and master the art of debugging.
            </p>
            <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8 max-w-4xl mx-auto">
                <h3 class="text-2xl font-bold mb-4">Anatomy of a DAX Error</h3>
                <p class="text-gray-600 max-w-2xl mx-auto mb-6">Errors in DAX can be grouped into several key areas. Understanding which category your problem falls into is the first step toward a quick resolution.</p>
                <div class="chart-container">
                    <canvas id="errorTypesChart"></canvas>
                </div>
            </div>
        </section>

        <div id="navigation-mobile" class="md:hidden mb-8">
            <select id="mobile-nav-select" class="w-full p-3 rounded-lg border border-gray-300 bg-white shadow-sm focus:ring-2 focus:ring-teal-500 focus:border-teal-500">
                 <option value="all">All Errors</option>
                 <option value="fundamentals">Fundamentals</option>
                 <option value="model">Model & Relationships</option>
                 <option value="context">Context & Logic</option>
                 <option value="performance">Performance & Advanced</option>
            </select>
        </div>
        
        <section id="errors-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8">
        </section>

    </main>
    
    <footer class="text-center py-10 mt-10 border-t border-gray-200 bg-white">
        <div class="container mx-auto px-4">
            <h3 class="text-2xl font-bold">Mastering DAX = Mastering Debugging 🧠</h3>
            <p class="text-gray-600 mt-2">Use this guide to build cleaner, more efficient Power BI models.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const daxErrorsData = [
                { id: 1, title: 'Syntax Errors', category: 'fundamentals', error: '= IF(Age > 18, "Adult", "Minor"', fix: '= IF(Age > 18, "Adult", "Minor")', tip: 'Missing parentheses, commas, or typos. The editor often catches these.' },
                { id: 2, title: 'Data Type Mismatch', category: 'fundamentals', error: '= Sales[Revenue] + "100"', fix: '= VALUE(Sales[Revenue]) + 100', tip: 'Use VALUE() or FORMAT() to convert types. Always check column types in the model view.' },
                { id: 3, title: 'Division by Zero', category: 'fundamentals', error: 'e.g., [Sales] / 0', fix: '= DIVIDE(Sales[Revenue], Sales[Quantity], 0)', tip: 'Always provide an alternate result in DIVIDE() to gracefully handle zeros or NULLs.' },
                { id: 4, title: 'Circular Dependency', category: 'model', error: '[Total Sales] = [Total Sales] + ...', fix: 'Redesign logic to avoid self-reference.', tip: 'A measure cannot refer to itself. This requires a logical redesign of your calculation.' },
                { id: 5, title: 'Relationship Missing', category: 'model', error: '= RELATED(Products[Category])', fix: 'Create relationship or use LOOKUPVALUE().', tip: 'RELATED requires a defined path between tables. Check your model relationships.' },
                { id: 6, title: 'Filter vs Row Context', category: 'context', error: 'Overusing FILTER() for simple conditions', fix: '= CALCULATE(SUM(Sales[Revenue]), Sales[Category]="A")', tip: 'CALCULATE() is a more direct and often more performant way to apply simple filters.' },
                { id: 7, title: 'Missing Date Table', category: 'model', error: 'Time intelligence functions fail or give wrong results', fix: 'Always create and mark a dedicated Date table.', tip: 'Functions like DATESYTD require a valid, marked date table to work correctly.' },
                { id: 8, title: 'Operations on BLANK()', category: 'context', error: '100 + BLANK() results in BLANK()', fix: '= COALESCE([Your Measure], 0) + 100', tip: 'BLANKs propagate. Use COALESCE() or IF(ISBLANK()) to handle them.' },
                { id: 9, title: 'Slow DAX Performance', category: 'performance', error: 'Complex FILTER(ALL(...)) patterns', fix: 'Simplify with CALCULATE() and variables (VAR).', tip: 'Use DAX Studio to find and analyze performance bottlenecks.' },
                { id: 10, title: 'Ambiguous Column References', category: 'model', error: 'SUM(Revenue)', fix: 'SUM(Sales[Revenue])', tip: "Always qualify columns with 'TableName'[ColumnName] to avoid ambiguity." },
                { id: 11, title: 'Errors in Nested Functions', category: 'performance', error: 'e.g., nested CALCULATE()', fix: 'Combine filters into a single CALCULATE() call.', tip: 'Avoid nesting CALCULATE(). It makes code hard to read and can lead to unexpected results.' },
                { id: 12, title: 'Invalid Aggregations', category: 'fundamentals', error: 'AVERAGE(Sales[Date])', fix: 'Use functions appropriate for the data type.', tip: 'Mathematical aggregations like SUM and AVERAGE require numeric data.' },
                { id: 13, title: 'Row Context in Measures', category: 'context', error: '[Quantity] * [Price] in a measure', fix: 'SUMX(Sales, Sales[Quantity] * Sales[Price])', tip: 'Measures need an iterator like SUMX() to perform row-by-row calculations.' },
                { id: 14, title: 'External Source Errors', category: 'performance', error: 'Errors after data refresh', fix: 'Validate connections in Power Query.', tip: 'Use IFERROR() in DAX for graceful handling of potential data source issues.' },
                { id: 15, title: 'Time Zone Differences', category: 'performance', error: 'Using NOW() across regions', fix: 'Use UTCNOW() for consistent time comparisons.', tip: 'NOW() is local. UTCNOW() provides a global standard for time-based analysis.' },
                { id: 16, title: 'Broken Date Relationships', category: 'model', error: 'Time intelligence is wrong with multiple date columns', fix: 'Use USERELATIONSHIP() to activate a specific relationship.', tip: 'Essential when tables have multiple links to the date table (e.g., Order Date, Ship Date).' },
                { id: 17, title: 'Missing Model Elements', category: 'model', error: 'Formula breaks after renaming/deleting a field', fix: 'Verify fields in formulas after model changes.', tip: 'Power BI will usually flag these errors, but its good practice to double-check.' },
                { id: 18, 'title': 'ALL() & ALLEXCEPT() Misuse', category: 'context', error: 'Removing too many or too few filters', fix: 'Understand ALL() removes all filters; ALLEXCEPT() keeps specified ones.', tip: 'Choosing the wrong function is a common source of incorrect totals.' },
                { id: 19, 'title': 'Wrong Measures in Visuals', category: 'context', error: 'Chart totals dont match the sum of parts', fix: 'Test measures in a table/matrix visual first.', tip: 'The filter context of a visual can significantly impact how a measure calculates.' },
                { id: 20, 'title': 'Bonus: Volatile Functions', category: 'performance', error: 'NOW() or TODAY() in calculated columns', fix: 'Avoid in calc columns; use in measures instead.', tip: 'Volatile functions in columns only update on data refresh, not in real-time.' }
            ];

            const grid = document.getElementById('errors-grid');
            const navButtons = document.querySelectorAll('.nav-button');
            const mobileNav = document.getElementById('mobile-nav-select');

            const createErrorCard = (error) => {
                const card = document.createElement('div');
                card.className = 'error-card bg-white rounded-xl shadow-md p-6 border border-gray-200/80';
                card.setAttribute('data-category', error.category);

                let content = `
                    <h3 class="text-xl font-bold mb-1">${error.id}. ${error.title}</h3>
                    <p class="text-sm text-gray-500 mb-4">${error.tip}</p>
                    <div class="space-y-3">
                        <div>
                            <p class="text-xs font-semibold text-red-600 mb-1">❌ Common Mistake:</p>
                            <pre class="bg-red-50 text-red-800 p-3 rounded-md w-full overflow-x-auto"><code class="font-code">${error.error}</code></pre>
                        </div>
                        <div>
                            <p class="text-xs font-semibold text-teal-600 mb-1">✅ Best Practice / Fix:</p>
                            <pre class="bg-teal-50 text-teal-800 p-3 rounded-md w-full overflow-x-auto"><code class="font-code">${error.fix}</code></pre>
                        </div>
                    </div>
                `;
                card.innerHTML = content;
                return card;
            };

            const renderCards = (category = 'all') => {
                grid.innerHTML = '';
                const filteredErrors = category === 'all' 
                    ? daxErrorsData 
                    : daxErrorsData.filter(e => e.category === category);
                
                filteredErrors.forEach(error => {
                    grid.appendChild(createErrorCard(error));
                });
            };

            const handleNavClick = (category) => {
                navButtons.forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.category === category);
                });
                mobileNav.value = category;
                renderCards(category);
            };

            navButtons.forEach(button => {
                button.addEventListener('click', () => handleNavClick(button.dataset.category));
            });
            
            mobileNav.addEventListener('change', (e) => handleNavClick(e.target.value));

            const chartJsDefaultOptions = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            color: '#4B5563',
                            font: { family: "'Inter', sans-serif" }
                        }
                    },
                    tooltip: {
                        callbacks: {
                            title: function(tooltipItems) {
                                const item = tooltipItems[0];
                                let label = item.chart.data.labels[item.dataIndex];
                                return Array.isArray(label) ? label.join(' ') : label;
                            }
                        }
                    }
                }
            };

            const categoriesCount = daxErrorsData.reduce((acc, err) => {
                if (err.category === 'fundamentals') acc['Fundamentals']++;
                if (err.category === 'model') acc['Model & Relationships']++;
                if (err.category === 'context') acc['Context & Logic']++;
                if (err.category === 'performance') acc['Performance & Advanced']++;
                return acc;
            }, { 'Fundamentals': 0, 'Model & Relationships': 0, 'Context & Logic': 0, 'Performance & Advanced': 0 });

            new Chart(document.getElementById('errorTypesChart'), {
                type: 'doughnut',
                data: {
                    labels: Object.keys(categoriesCount),
                    datasets: [{
                        label: 'Error Count',
                        data: Object.values(categoriesCount),
                        backgroundColor: ['#f59e0b', '#3b82f6', '#ef4444', '#6b7280'],
                        borderColor: '#ffffff',
                        borderWidth: 4,
                    }]
                },
                options: chartJsDefaultOptions
            });

            renderCards();
        });
    </script>
</body>
</html>
